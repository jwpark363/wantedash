<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>프롬프트 관리 페이지</title>
    <style>
        /* 기본 스타일 */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f4f7f6;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* 관리자 패널 컨테이너 */
        .prompt-manager {
            width: 100%;
            max-width: 700px;
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            padding: 30px;
            box-sizing: border-box;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-top: 0;
            margin-bottom: 25px;
            font-size: 1.8em;
        }

        /* 상단 컨트롤 (선택창 + 신규 버튼) */
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }

        #promptSelect {
            flex-grow: 1; /* 남은 공간을 모두 차지 */
            font-size: 1em;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background-color: #fff;
        }

        .btn {
            padding: 12px 20px;
            font-size: 1em;
            font-weight: 500;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            white-space: nowrap; /* 버튼 글자 줄바꿈 방지 */
        }

        .btn-new {
            background-color: #007bff;
            color: white;
        }
        .btn-new:hover {
            background-color: #0056b3;
        }

        /* 프롬프트 편집 폼 */
        .form-editor {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .form-editor label {
            font-weight: 600;
            color: #555;
            margin-bottom: -5px; /* 라벨과 입력창 사이 간격 조절 */
        }

        .form-editor input[type="text"],
        .form-editor textarea {
            width: 100%;
            padding: 12px;
            font-size: 1em;
            border: 1px solid #ddd;
            border-radius: 6px;
            box-sizing: border-box; /* 패딩이 너비에 포함되도록 설정 */
            font-family: inherit;
        }

        .form-editor textarea {
            min-height: 200px;
            resize: vertical; /* 수직으로만 크기 조절 허용 */
        }
        
        /* 저장/수정 버튼 */
        .btn-save {
            background-color: #28a745;
            color: white;
        }
        .btn-save:hover {
            background-color: #218838;
        }
        .btn-save:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

    </style>
</head>
<body>

    <div class="prompt-manager">
        <h1>프롬프트 관리</h1>

        <div class="controls">
            <select id="promptSelect">
                <option value="">-- 프롬프트 선택 --</option>
                </select>
            <button id="newBtn" class="btn btn-new">신규 등록</button>
        </div>

        <div class="form-editor">
            <label for="promptName">프롬프트 이름:</label>
            <input type="text" id="promptName" placeholder="새 프롬프트 이름을 입력하세요">

            <label for="promptContent">프롬프트 내용:</label>
            <textarea id="promptContent" placeholder="프롬프트 내용을 입력하거나 기존 프롬프트를 선택하세요."></textarea>
            
            <button id="saveBtn" class="btn btn-save" disabled>저장</button>
        </div>
    </div>

    <script>
        // --- 데모를 위한 가상 데이터 ---
        // 실제 환경에서는 이 데이터를 서버에서 API로 불러와야 합니다.
        const mockPromptData = [
            { id: 1, name: "일일 업무 요약", content: "오늘의 주요 업무 3가지를 글머리 기호로 요약해 주세요." },
            { id: 2, name: "공손한 이메일 작성", content: "다음 요청 사항을 바탕으로 정중한 어조의 비즈니스 이메일을 작성해 주세요.\n\n[요청 사항]: " },
            { id: 3, name: "코드 리뷰 요청", content: "제공된 코드 스니펫에서 잠재적인 버그, 비효율적인 부분, 그리고 개선점을 찾아주세요.\n\n[코드]: " }
        ];
        // ------------------------------

        document.addEventListener('DOMContentLoaded', () => {
            // --- 1. DOM 요소 가져오기 ---
            const promptSelect = document.getElementById('promptSelect');
            const newBtn = document.getElementById('newBtn');
            const saveBtn = document.getElementById('saveBtn');
            const promptName = document.getElementById('promptName');
            const promptContent = document.getElementById('promptContent');

            // 현재 편집 모드 ('new' 또는 'update')
            let currentMode = null; 
            let selectedPromptId = null;

            // --- 2. 초기화 함수 ---
            function initialize() {
                // 가상 데이터로 Select Box 채우기
                mockPromptData.forEach(prompt => {
                    const option = document.createElement('option');
                    option.value = prompt.id;
                    option.textContent = prompt.name;
                    promptSelect.appendChild(option);
                });

                // 폼 초기 상태로 리셋
                resetForm();
            }

            // --- 3. 폼 리셋 및 상태 관리 함수 ---
            function resetForm(mode = null) {
                promptSelect.value = ""; // 선택창 초기화
                promptName.value = "";
                promptContent.value = "";
                selectedPromptId = null;
                
                if (mode === 'new') {
                    // 신규 등록 모드
                    currentMode = 'new';
                    promptName.placeholder = "새 프롬프트 이름을 입력하세요";
                    promptContent.placeholder = "새 프롬프트 내용을 입력하세요";
                    saveBtn.textContent = '신규 저장';
                    saveBtn.disabled = false; // 저장 버튼 활성화
                    promptName.focus();
                } else {
                    // 기본 (선택 대기) 모드
                    currentMode = null;
                    promptName.placeholder = "프롬프트를 선택하거나 신규 등록하세요";
                    promptContent.placeholder = "...";
                    saveBtn.textContent = '저장';
                    saveBtn.disabled = true; // 저장 버튼 비활성화
                }
            }

            // --- 4. 이벤트 리스너 바인딩 ---

            // [이벤트] 프롬프트 선택 시
            promptSelect.addEventListener('change', () => {
                const id = promptSelect.value;
                if (id) {
                    // 선택한 ID로 프롬프트 데이터 찾기
                    const selectedPrompt = mockPromptData.find(p => p.id == id);
                    if (selectedPrompt) {
                        currentMode = 'update';
                        selectedPromptId = selectedPrompt.id;

                        // 폼에 데이터 채우기
                        promptName.value = selectedPrompt.name;
                        promptContent.value = selectedPrompt.content;

                        // 버튼 상태 변경
                        saveBtn.textContent = '수정 등록';
                        saveBtn.disabled = false;
                    }
                } else {
                    // "-- 프롬프트 선택 --"을 선택한 경우
                    resetForm();
                }
            });

            // [이벤트] '신규 등록' 버튼 클릭 시
            newBtn.addEventListener('click', () => {
                resetForm('new');
            });

            // [이벤트] '수정 등록' / '신규 저장' 버튼 클릭 시
            saveBtn.addEventListener('click', () => {
                const name = promptName.value.trim();
                const content = promptContent.value.trim();

                if (!name || !content) {
                    alert("프롬프트 이름과 내용을 모두 입력해야 합니다.");
                    return;
                }

                if (currentMode === 'new') {
                    // --- 신규 저장 로직 (시뮬레이션) ---
                    const newId = Date.now(); // 임시로 고유 ID 생성
                    const newPrompt = { id: newId, name: name, content: content };
                    
                    // 1. 가상 데이터 배열에 추가
                    mockPromptData.push(newPrompt);
                    
                    // 2. Select Box에 새 옵션 추가
                    const option = document.createElement('option');
                    option.value = newId;
                    option.textContent = name;
                    promptSelect.appendChild(option);
                    
                    alert(`'${name}' 프롬프트가 신규 등록되었습니다.`);
                    
                    // 3. 방금 등록한 프롬프트를 선택 상태로 변경
                    promptSelect.value = newId;
                    promptSelect.dispatchEvent(new Event('change')); // 'change' 이벤트 강제 실행

                } else if (currentMode === 'update') {
                    // --- 수정 등록 로직 (시뮬레이션) ---
                    
                    // 1. 가상 데이터 배열에서 원본 데이터 찾기
                    const promptIndex = mockPromptData.findIndex(p => p.id == selectedPromptId);
                    if (promptIndex > -1) {
                        // 2. 데이터 업데이트
                        mockPromptData[promptIndex].name = name;
                        mockPromptData[promptIndex].content = content;
                        
                        // 3. Select Box의 옵션 텍스트도 업데이트
                        const option = promptSelect.querySelector(`option[value="${selectedPromptId}"]`);
                        if (option) {
                            option.textContent = name;
                        }
                        
                        alert(`'${name}' 프롬프트가 수정되었습니다.`);
                    }
                }
            });

            // --- 5. 페이지 로드 시 초기화 함수 실행 ---
            initialize();
        });
    </script>

</body>
</html>